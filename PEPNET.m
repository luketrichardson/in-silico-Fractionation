function [y1] = PEPNET(x1)
%MYNEURALNETWORKFUNCTION neural network simulation function.
% Peptide_BG_Binary_SCG_30x2_PE0723_USED
% Generated by Neural Network Toolbox function genFunction, 20-Jul-2018 00:28:21.
% 
% [y1] = myNeuralNetworkFunction(x1) takes these arguments:
%   x = 7xQ matrix, input #1
% and returns:
%   y = 2xQ matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [17.03857658;0.0257806188440688;0.000149534615579603;0.00448005516562635;0.127546458;2.67123074293765e-05;0.000103015];
x1_step1.gain = [0.000319645680362191;0.0200051574533922;0.0200000299069678;0.0200008960511767;0.000230945525718464;0.000393950497909887;2.00043852212975];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.1971089708529363271;2.0242069573605325772;1.9464906413666951401;1.8107073513030247369;-1.4998341385522162561;-1.1620782388256638562;1.334639736389179987;0.97985147962982110936;-0.83032940336117466718;-0.75521620814295076229;-0.58347602668343145904;-0.63630506776091766419;-0.39018009368848061147;-0.29038807082611306498;-0.0028856200348061932827;0.2544363782002602159;0.12563212674205578856;0.48433521934567924649;-0.45883744709195367628;-0.62996083336138752884;-0.84105318901262227094;-1.0067835412918277882;1.2920087255113712477;1.3009388665993681933;-1.5462485363047571152;1.9097862799869851358;1.7710918462157301256;-1.879858511960038836;2.1085410111098350505;2.330771718583933616];
IW1_1 = [-0.037231588370401053067 0.063260269945205990783 -0.77625893375789389861 1.6281786907318960278 0.77897959628172741553 -0.31339033933985560587 1.3400340491918711905;-0.83092280149276498413 -0.82715323908794302632 1.8310794864989778929 -0.8195619917196781401 0.80038954952154695022 1.1140304879120341841 1.1488378445146543161;-1.5079986056461287536 1.3307849798991517876 0.28841943440544570709 -0.3035645991630208651 0.9920151462513177032 -0.072933793078255135245 0.017929854495757759775;-1.509046604874626718 -0.76073401952392494252 -0.80512351191915720872 0.92818408661687845651 -0.54040939867406290187 -0.71583484756753645861 0.069366135703964354464;0.59330719049729119252 -0.98380461587982659388 -1.2601453607775485732 -0.32352984887306757145 -1.2090294103590069064 -0.57765851329115325274 -0.77637273611697632525;0.44460963600387598538 0.7206081683959639772 0.72237930753850976284 1.4645487838148854021 -1.1885201165897891773 -1.0045304196093065574 -0.10203306107840193206;-1.3904277357686429806 1.2916348218019682026 0.25880881586687320972 -0.57590766876942256491 0.73534852381878978989 -0.41135045067638292826 -0.61734239003403945656;-0.98201972284843341843 0.26476755405520169262 0.76016513870117252694 1.2584558958831251196 -0.85225134900155441464 1.5635167531383831196 0.25874004418418300455;1.8239581926771002429 -0.026024435885502940347 -0.23775056971879821033 1.1332740888284191794 0.38676778684856660817 -1.4287175927682096432 0.19466944653758164185;0.85514618972215650228 0.69356252846478472218 1.1293149791243974889 -0.5372298157614834313 -1.0311785215648043845 1.0122882312327678989 -0.17946267335869939274;1.0728148897452161048 0.71837683775742455783 1.6246569714061214196 -0.64433286302301995274 -0.073530228202047909214 0.91690490874279617639 1.3692294444037711454;0.55469906178845473921 -0.69103854165814571076 1.2935397497874192574 -0.36432830501638568954 1.4718682398385991572 0.70668212010763775677 0.24747485857186080072;0.49735565027829348184 0.53978275932338637411 1.180559469071736256 0.70889272181505391668 1.4649268706796163553 -0.10776422882975314477 1.25459394892402476;0.71161845687314051467 -0.57824692290316404009 0.18246892225873156956 -1.1698273034739530285 0.48479108014614802347 1.2461648012613426584 -1.1127784435944361174;-1.3588945857311816034 0.11009780216197007086 -0.5649852801657543333 1.3589655738333212831 -1.0844929270170304836 1.1617513424234802155 0.51873443531479102031;0.6330842185856104809 -0.18629656405023509169 1.294537150872233866 -1.4054060548845217493 0.82037813530895853376 0.50574688338415574318 0.84726330874826827344;0.79683916575579738506 1.1140387998676180015 -0.19685948233330721746 -1.2102134212682107428 -0.16675992607954501223 1.1948370845468399004 -1.5518746398462555103;1.5042576182126348172 0.92248130214016499373 -0.45808271232384140115 0.97546192953082999644 -1.1015391605013700183 0.81005848443714756346 -0.36550308925348884426;-0.52688508972640679673 0.12125482049404096019 2.0747180548790131738 0.65945512839505338043 -0.58537705821279872875 0.25225779140339898987 2.0149131629229146689;-1.1833686266900613759 0.99856256787810093734 -0.1384418845392054731 -0.62908803506283816898 -1.4333382110655776831 -0.67841974372798174997 -0.11081408896795411079;-1.2528291045013197902 0.57535457833258629723 -0.77629009998461928621 -1.2631980198596737264 -0.60104039029475941902 -1.1077351703450986076 -0.51071434432691664718;-0.80263003744617300583 -1.4798732396532134903 -0.047093996355664850817 0.39737180669116145548 0.9054527362257617229 -0.6897690316757020268 -1.0553895203185355012;1.5016931832590860729 -0.39135028509150959763 -1.1036100785951656889 -0.7089382164515732887 -0.97587828384808827931 0.86547366160010497094 0.34066871729913211775;1.1889090831281088345 0.10544439655547924173 0.71058704441914921635 -0.21148383692851518978 -1.2696873467185556539 -0.24704876437763848007 1.2474257063745401997;-1.4248143402111708156 -0.55268724003824398761 0.4828781752591324028 -0.46448869987238805557 1.1333802179085468165 -0.6102279855830531341 1.0203298351746323824;0.16341701102069933205 -1.1771869136934145494 0.36264553534571836169 0.86970396240805647459 0.11603470573203150673 0.58221215681485372073 1.8017099644978091799;0.56491754561220675068 -0.41326813497758813076 1.1866513695437514997 0.16260978851901783382 -1.2723852458201976301 -0.35717188245500147703 1.2440629995383511996;-0.54845510954946274929 1.2838425027491975339 0.74426723506556280441 1.1547862677004536724 1.0205707601198579226 -0.21626711394350536799 1.018693249728873873;0.50359596071269152606 0.26565058856405976417 -1.463987636268073711 1.1564408510919208517 0.199522229478721419 -1.1453952424499924678 -0.085089328216557749696;0.30948003701000981192 -1.0602687984213656769 0.82074589573444756141 1.0897627611124478531 1.1471332933179578806 -0.22378801318651700414 0.96701900973781873549];

% Layer 2
b2 = [-1.4292801148323883709;-1.4793933315422500563;-1.4751331460272056884;1.3541761968216137202;0.98935396187822144398;1.0975379567728555941;0.90425825543731874756;-0.8859929212054853398;0.73195806425293508113;0.68363887780261134441;-0.56916768951247354025;-0.37111559714641167984;-0.35410522855644765983;0.28155075416274655264;0.029251696935367377944;-0.050918183421308223224;-0.27344728791150380021;0.27011875640419996669;0.39261285388757560799;0.43438994386614010468;0.52731669138793513252;-0.71894323946035421091;0.7624718376780128537;0.98253480063721287951;1.0197723036091899118;0.98890590186895277469;1.0958624728311210372;-1.3897070225873822125;1.4338160226167175892;-1.5736036720609920536];
LW2_1 = [0.38128279401709341823 0.12178502070363429743 0.22420468954748004609 0.55807952870140309365 -0.20091306430731495358 0.0018732842570841545457 -0.094416293968970221862 0.13756210384462994045 -0.38491727337526304709 -0.32954724249348088527 -0.33383303502948269426 -0.40711978004466914394 0.22387551405363581569 0.29112839839546461596 -0.14213915791189896121 0.073005336157913880424 -0.57064427592550603929 0.044505167984211974064 0.47187977666754621353 -0.26355806624159983098 0.36320036496034924234 -0.32230341566308118306 0.51610525068763568601 0.57043223983591162529 -0.49891956740088710953 0.083927714083800258882 -0.11723876538600878916 -0.13161484227892014665 0.23332519495311299096 0.17821338524864943631;0.12687271405881528352 0.22722147365068812164 0.45528862974712014378 -0.44781594751672282317 -0.31077162636254113126 0.37460606510814953296 0.15685509579609824282 -0.11043340515336937113 -0.46319500656949580408 0.28610890135236988208 0.086622602898780889924 -0.41424452337844841487 -0.21807063355410455374 0.42290286202004329086 0.45449887749874601228 -0.61872579403020022681 -0.52161144033420869803 -0.16814163467042320121 0.31430093392386976303 0.26789742885169942621 -0.14702420530161114387 0.43959398814692929314 -0.14322881706956608339 -0.13049943753648091116 0.014663368441244689633 0.60586371366195312937 0.36929469315450241806 0.37015197356696677433 -0.43238758155935741456 0.059251220344948486718;0.31303060753077610601 1.0290010820298383099 -0.28846157307542691361 0.20973507404294472467 0.018660556051917340237 0.029860672507182255825 -0.20142394929498799727 0.80002673633421184096 -0.81054158681028287692 -0.31638699324235947108 -0.97384653613812566242 0.051145722769742101022 0.06369171342832199989 0.066194455048490488669 0.37656267544877791709 -0.70356670126112241803 0.40427771444326399131 -1.1893643209250623904 -0.41465890519145326421 -0.1646501025082229841 0.34203144441343635851 0.15643597948337406578 -0.68908610903214950749 -0.36148101175438407395 0.27625742394792968115 -0.96671420726835044501 0.33106074495016069026 -0.084566170447549965372 -0.51951451370955648024 -0.49796332290346989602;-0.10673677565542780132 0.22428718599063135475 -0.38262256456344090338 0.58116854088555824909 0.37639167482770452544 0.31074871695853251152 0.17886959019392587034 0.23782589723075428512 -0.46025742428101112935 -0.47173693778673997379 0.16067312406400199865 0.005551269678076039063 0.19825344664769173342 -0.11056932544006112251 0.056565451410932110488 -0.40977246867303196431 0.073504733692824397728 -0.4650520061115702708 -0.036800401148370791293 -0.017134776841335179476 0.20653618269019249909 0.23810778307180524571 -0.36303468464091720458 -0.39421332296788369476 -0.19483589993335567736 0.10602446414399373242 0.28102036890706583172 0.077334381702974241968 -0.13214317612802239932 -0.04614314944496043791;-0.22845275121499800108 0.50691817915209713696 -0.34585721974730337935 0.25677123419560410333 -0.37958080023986073837 0.45577036769897771862 0.28498338664261391173 0.085280407279810926946 -0.22809974051848858068 0.33542744856468592607 -0.35737357922864304571 0.38868653573190670159 -0.27753871496911552974 0.00026933752626332873193 -0.28852586379898653712 -0.080468197420580311885 -0.2605215770402982689 0.0057064208177770017402 0.41502531610245435578 0.19167646300249854829 0.44141643812708614147 0.51863837281989078054 -0.64085319980232513526 -0.41470946899678623465 0.44590984569251496117 -0.27973702500802516413 -0.55460574660337824682 -0.10606243671745871349 0.29936548947793945041 -0.30375779767791033503;-0.37884335053554435424 -0.50984589490629439457 -0.37048795419240754256 0.22767545162640379086 0.031596758559677112776 -0.42862954817749859826 0.18700459811891437245 0.082886450398475572388 0.51827317193098920711 0.24864167532718592368 -0.11738001326178021388 -0.17804024703778617567 -0.26229114408987252993 -0.19207747795380453182 -0.54400646358463966568 0.58131985738120772744 0.84344367761510474768 -0.014440511184876445375 -0.56037808797754207202 -0.15178114728655395238 0.15262383820884400931 -0.42907334256478585344 0.38287361999593166884 -0.22315933404867244194 -0.54744931768990090504 -0.3362022582536635662 0.061433076934931114821 -0.10511788196808979912 0.42781892833717383162 -0.40781923997667612891;-0.46502058517019317918 -0.013065296338635403253 -0.34554175676737486356 -0.32038336289611279994 -0.26214914049251930583 0.11486448224503285898 0.46063547765107232257 -0.029870531296588957032 0.44694594222405781281 0.56887386365912662178 0.16560975413631498498 -0.082986705297861187991 0.13459849969207887677 -0.33078022994302869186 0.11223902718906761389 0.33445932807917122531 0.10724421286488663996 -0.060071158979557136293 0.19467436748507993549 -0.06358850955739132893 0.077241588306238548323 0.1013213062556312799 -0.24929493150190321082 0.10275032439293683983 0.10980079260153334519 -0.20869822701688831024 -0.48279842791349814046 -0.2003222936885466765 -0.49648467518398031739 0.48719254018233587589;0.28582703667043590778 -0.32899663067889511892 -0.2510420780159564047 0.06194669665480598969 -0.13294276238386765199 0.28218087848298145648 -0.17713347112771740677 0.28030080985962080309 0.19213208106999860036 -0.32420552054553863908 -0.19748472455957680194 0.50055377344960416686 0.13016979099319822555 0.38898464776988744829 0.34675252850846638442 -0.17875795440385616741 0.28157886863791925514 0.42458407562402999957 0.38852574318578059209 -0.39104101305048788451 0.098205212027190180724 0.40572659520865717031 -0.15386246029634242927 -0.17821567898286938547 0.45749146897603232276 0.028871666122667588583 -0.16051751517047566087 -0.053375374058043524583 -0.043490998487675097683 0.2558880815578311041;-0.078625899715233982246 -0.24442399959759247841 0.49319049656861890796 0.045185940827017712085 -0.2020138135038176963 -0.20436035234021565632 -0.17199990761905900594 -0.39303048350720537485 0.38770623279665628047 -0.44871938343259115678 0.63978768117348683298 -0.33409145451083299694 -0.13047633733681698875 -0.15725172546637858351 0.95658258446372390615 0.20847013183831628047 -1.1042801436649340996 -0.020379617887570179724 1.5021980219729123007 -0.40567802298270494443 -0.078969198740996324193 -0.29359070183116359187 -0.26648532517238199269 0.37283214600059561006 -0.085913368383841143272 0.39964013633134676251 0.12979696344439661804 0.37249488440117911603 -0.021246772153234297353 0.84515050936776192625;-0.30399208952089534774 0.24260370449665030756 -0.14537219118499258852 0.39701066097292458945 0.17581144575552373754 -0.50873193619647416597 0.099056971664432669211 -0.26232365059544521246 -0.38253181875243841281 0.14071942277844709523 0.52328212250331052058 -0.22034521032567916388 -0.042049644150155926492 -0.36815600120667807404 -0.16607454579638081249 0.47970181163034542049 -0.14127151710259805428 -0.45546765115022641579 -0.40310173525766951341 -0.34653379816481194586 -0.15748931009657746172 0.2983457408856305948 0.0033804022337760352215 -0.31385921154944412814 -0.13047935142917249651 -0.22454952716950746239 -0.33772041421128062844 -0.38326966957884828213 -0.38846913450402120738 -0.32553654052583375078;0.4058281385221079729 -0.0035866505738961678221 -0.39471673235064080876 -0.21023753754720481135 0.33704774400711640103 -0.40589577447468710991 -0.34773107512988721268 0.12333565316253168598 0.225439668302415408 -0.49624331858041687005 0.038859269901528999125 0.33183958349443853919 -0.1385579003898744499 0.073462335105213966147 0.040756018578039766853 0.4813344084252098587 0.43535079535538706574 -0.04669590440406878179 0.056496322120041041204 0.38468038030759199586 -0.378645210141613342 -0.24976807795808450563 -0.12850559574256212314 -0.12906885533869633109 0.30197650510551959924 -0.04534616037200946137 -0.35920362557203611154 0.36679529582215258943 -0.39066769701220210864 -0.26622086700651043101;0.17183616510611543493 -0.47828490675092727447 0.10440808055498654316 -0.36446268171914475431 0.35549835031134818797 0.06873893675880213272 -0.54766998845414360808 0.19514941160899648698 0.49473106750892786865 -0.092548636892475652505 0.42380509986352726814 -0.42073041876673367145 -0.22906501631181336309 0.051231028849742253628 -0.16011337609482639843 0.18121594626267353845 -0.38462109776371505854 -0.39326751705540530235 -0.21795246968132714338 0.29524827191070956989 0.144140969301437466 0.021662854396374948973 -0.2513279494768466682 -0.26135119841717296962 0.2270845818385882342 0.2462494313798760659 0.27967354310004510776 0.11477359826927499564 -0.35721891341322165037 0.14087649585872866198;0.35522662247565350846 -0.21032694238035981593 0.34015798721489187706 0.16870977900355160761 -0.29450640334872352222 0.56642937615421773412 -0.44554784264247138115 0.37476929625935107016 0.067729603046269029609 0.041877794865849388151 0.25901807061252557496 -0.05464390982883316622 -0.0054761125048689313771 -0.36321574457297861604 0.4690611785287904234 -0.30160109939250101529 0.1410795433333853488 -0.038492211215820137937 0.1598818347651327354 -0.44147537670085856831 0.083904284127616468592 0.35847120929901726827 0.29382303689110461642 0.30340900577601759291 0.32422116947187251679 0.27350104900392407936 0.088662607879525762167 0.20904104067547549239 -0.068842786884893300559 -0.28791065681441363466;-0.18599786274706547884 -0.53329442419046868551 -0.16941218915612116236 0.20802526091965878319 -0.1517866512327633588 0.11273570001041921529 -0.46203190875870808751 -0.73014912981808288706 0.68155265492180028275 -0.12004480123729921459 0.45456826843280079276 -0.52732811623776998378 -0.54166127411335740494 0.34537758183271455303 -0.67667077220974425344 0.071010439561597860081 -0.10926890635684963216 0.029535195478512375755 0.24305933684087510649 -0.35953286981213422591 -0.39329124760525596693 -0.42722165928335831264 0.92705111167154763407 0.3738572314329259294 -0.51763450496668828027 0.66721969163971595052 -0.22828074560165478868 -0.47721048033796537036 0.14894500009755998193 -0.21865805023122927842;-0.5025933173376209151 -0.44626230643008951704 -0.17568382955297137671 0.027373015065042350519 -0.18474804729002364256 -0.06616602356931672313 -0.24558756820322347192 0.34532799516873718959 0.35235163268802460745 -0.36411284198573584669 0.47676836636893982213 -0.19282645525980357526 -0.055052339623361548626 -0.27471345887623443982 -0.2246543613185826016 -0.23107454675817665213 -0.40041419998747701525 -0.19693555554778494066 0.20257703140624222504 0.27342760759617296129 -0.31072797256860479331 0.054239151999306824126 -0.55394765516166510899 0.39431023578444934774 0.18742306144117409916 -0.055583912983246046291 0.16083322483478085241 -0.30917136410137840974 -0.25319419621474631432 0.1787684869192058823;-0.47148128438551178965 -0.8002242333672197061 -0.43754959118769304327 0.43360310737237561796 0.22857542478383513496 -0.68078572331212661162 0.34379843479788757543 -0.67833044998719027596 0.23570593435437844909 -0.31014623258169682352 -0.23338435085905367972 0.37400452008840578966 -0.098077896610879997108 0.039386882178687486478 0.044471829129889076104 -0.16382225074822648336 0.14233818696965450101 -0.050119642433711281138 -0.16622841706648619486 0.34349576185226210479 -0.33267730641158033134 -0.045688912607054071868 0.19285118865290781787 -0.24457606238299434143 0.18035477629981400138 -0.41569543870922931461 -0.00054733688836171756793 0.38057390216169689756 0.40779692925117710933 -0.10430916689052255331;-0.13228906939535881038 0.37308804611212781355 -0.056321198708568116775 -0.51593548259829991043 -0.32512317333241985695 0.081560654696683970721 -0.049417726308591175544 0.58217738714841882341 -0.22246258227653686879 0.099372989184001281338 -0.15501710141675575927 -0.26195895754547904311 0.44465225186546575298 0.1439824488752334819 0.21394058713918687187 -0.46886521391953767113 -0.35834919363290235195 0.3883780277913654877 -0.0076312994204039523438 0.38803482027683994238 0.47865474674146851752 0.49231439985636321621 0.23080954505530443255 -0.29751334792303096854 0.17474978329142826228 -0.041566503974506875674 -0.35084647737273860768 -0.35223141287276310551 -0.12161665433487973964 -0.15684212481305576103;0.40327175380223306833 0.096422340132181191819 -0.24172421125219342719 0.18664215392414021388 -0.22578942815290115043 -0.11375433336615810298 0.20587214055887753661 0.31067499175573665138 0.065998337047157129565 0.14443287829156273294 0.10915576361306909836 -0.24361561876474496779 0.124001337305459855 0.15408759173817801469 -0.57971659692722521395 -0.2407909786282968756 0.014114037305077986595 -0.51130557736324855345 0.37501490870780035403 0.0002566530310957478001 -0.057121555240083991822 0.37165367575236013531 -0.28488266653699501063 0.44815014200548286549 -0.40285867007405856688 -0.073173586759768413645 0.55304594736672463284 -0.072199076995330499495 0.26673982050144878775 -0.28956798537306466246;0.21102054311822679433 -0.10246600210373699169 -0.33945016362701818657 0.1963306996877096644 -0.24950902606160171859 0.079553124833650984415 -0.20170902888330086156 -0.45603092763275493438 0.15926540934527988469 0.17180440539692809487 -0.48503331958282241976 -0.45608775124185119143 0.25891593797112205655 -0.22395707901662761929 -0.2032657132932877142 -0.49228490062799645788 -0.37354753786134620164 0.043636526265584049677 0.18795184113415011606 -0.059162251048231681572 0.32609220043459480332 0.29426435800295930312 0.32821142845433726176 0.51484474276698855011 0.097568776025019024467 0.023931418540888354379 0.12861186641636446204 -0.15242095776435474197 0.33004346311181970153 -0.42466361134862523619;0.23831538682484479375 0.5778549971782200867 0.19511583103501617398 0.22585447672007760711 -0.3674983451551849245 -0.094463636934096123499 0.059096266546671070985 0.61685825265808647 -0.3099192008625321626 0.058970647082676963535 0.42738648440876475521 0.33333037201437837327 0.24873749289061561352 0.36862609911404253804 0.423176486533936691 -0.0011905819859152938674 0.2520884131063507172 -0.063018736890783078053 0.57357708996891565434 0.33159471535880585824 -0.37006229189294054249 -0.13220799045046419118 0.040491447933961838279 -0.43646624783288995308 -0.36710923478216123117 -0.28700836804568485849 -0.3327519573548736731 -0.37888988827851177721 0.21693255411036990732 0.087575640177046942814;0.25670256350165499004 -0.020552830014198761321 -0.063659081944950485221 -0.069791725522218600597 0.22463807488149650782 0.10917951794617423988 -0.11403481538470099099 0.010430366341307045069 0.21332053882606644146 0.14466474138591758902 0.23581999672976031168 0.24134452654778285052 0.51394956550209380808 0.35168499075126347098 0.47098923277947929433 0.3725586829209369677 -0.81261111279964137744 -0.71332918377829512835 0.73104032704296417755 -0.056260505037130835448 0.19565639435528922596 0.27825383982982354603 -0.56388210588849674298 0.32632433148097617082 -0.34038339493228925159 0.51384162221447859942 0.076634003783347282024 0.40812579696375322902 0.22806526476169852735 -0.21149540736044292188;-0.33588334759747839886 -0.1735231623290232339 -0.26969281893683599849 0.45080894246153907501 0.018303350444590225227 0.14876333853147497011 -0.2112845109178267955 -0.38114612415481957663 -0.054238282591672251631 0.053069006249240380235 0.095394505903709431172 0.25754973063940911349 0.5339201378356629446 0.02399306075700351551 0.021234477494076062914 0.51476293789897298314 -0.36366271002530847767 0.080190815956137653786 -0.21181725643506635337 -0.13091261266861145551 0.39143167421586383403 -0.49293635036332572597 0.26666207994147389515 -0.087227770499678350391 -0.31051949428543451637 0.49178088092397526099 0.29110803645705957132 -0.092416265185636017887 -0.32571909611668203866 -0.15599990335013722009;0.34282460948788312516 -0.051743941924374266261 0.031562130941241745008 -0.092578270956732641728 -0.32008000394509139586 -0.048682316744994742763 -0.082401544219542238734 -0.16975291437565437347 0.035048884590872783629 0.022361984327466326306 -0.20770171730983130742 -0.16687024728248017746 0.53887396939652676409 0.34728940049637474496 0.36152042109517856794 0.43937018063935651124 -0.24940896106266413623 -0.55255757693595120017 0.26174608731991766408 -0.16640620291606969539 -0.43161090296668558342 -0.10895989363160880903 -0.1281776369721836506 0.31876849039976068445 0.47376067791201470492 -0.29678038236600040589 -0.44711805041213664724 0.46825495619877377518 -0.36461775152788755694 0.50276924574073578178;0.36537351328783490567 0.38398338860837649689 -0.24834414763754983357 -0.028076534248364613811 -0.38960950333924465605 -0.18149053525496883221 0.38368055890044655554 -0.19253703810086708614 -0.07932738109701133189 -0.25862596400273185626 -0.022713245062266747276 -0.30771501419944180533 0.16754383836265052121 -0.48485784737904308317 -0.21808795174302289532 0.23879368385083038495 0.3401421378318786326 0.3711766032461513154 0.38394212841753122545 -0.010095279699623841904 0.067483858528859630432 -0.28261664862379320962 0.042513056260014669974 0.43176618221034146483 0.30091866480988122001 0.27679102126807353379 0.14619028882515833212 0.34677668681601908629 -0.26231159757160354973 -0.3685305638204807166;0.093939338424222973423 0.35807073070954537064 0.048194477905282043229 0.23337994921380786351 -0.44117897624036683801 0.31320784517317862283 -0.019600914046619476172 -0.45678760472943069626 0.26523846675820561547 -0.40277576247218832561 0.39115926620094654265 -0.25612952108991615674 0.089214896631132356575 -0.25297264553281317845 0.2824225501152501927 0.38490444249574518043 -0.20065301136588836739 0.3429161728299077172 0.21539989423777239352 -0.090415884480200409135 0.42050281651392057425 -0.074387479498751782336 -0.015738116524269377822 0.40014110500166100159 -0.29595211689071332373 -0.10108408372688003352 0.24106668366795883096 -0.40841884708407988347 0.15300690886939055657 -0.33470071721742250537;-0.24709128827012291629 -0.27244196965649691844 0.24737261894519035899 0.20747403594171459629 -0.17730888818217996339 -0.23657764528238467427 -0.20601872574476867706 -0.23600335379159548266 -0.31360686756799266428 -0.47775689196286741378 -0.47259070980114314953 0.31316531204917158471 0.078085022290156486102 0.081505361797008707425 -0.050127767066906296634 -0.18290022187805221598 -0.33421809357425735776 -0.5211502744538337728 -0.72355800875220299684 -0.40138819169165051992 0.50789490889648492011 0.42228759244815305962 -0.16259953669270627019 -0.54683865398089992471 0.066336692440680855576 -0.23980419743172748381 -0.43466222943866089645 0.30834656943804444884 0.4111032492448890574 -0.82635217839341512658;-0.002671707342478077743 0.51217019081083492438 0.31656652988936506699 0.19075269208325698611 0.16679506835246227237 -0.44674888275585561415 -0.086295191434874268799 0.1917862692436042571 -0.41840211537230787009 -0.36608442502198090818 0.063705425735903417617 0.45626716418650042906 0.55979682948118592023 0.46457728300853040615 0.64073436420858387308 -0.17972922577075720052 0.30361694667337574272 -0.43869541138689982507 -0.51546388771757634117 -0.39566656424549973003 0.53635434364580603095 0.37977512016052838995 0.23273145673533091049 -0.44377818753070241709 0.39562786928721821456 -0.18674266870882472169 0.22977284232106642836 0.51592573326287727298 0.079813650827268392551 0.04236724268144640565;-0.1062663522888032952 -0.25077819586210192693 0.11428100301910527892 0.32551890078164630316 -0.086952100114620234361 -0.12049459812739003739 -0.44688373518471052881 -0.30601231374388337958 0.48076038096873974226 0.26891988502387847992 -0.20199407981369532639 0.26350956248606383081 0.2340796429780787058 -0.12737556366766158988 0.40416945604394427516 -0.27487481192595675239 0.34213507181961883008 -0.010738111493345327968 -0.23086549161295419341 0.19306365145525619664 0.29434845716511853775 0.5157947091714359944 -0.38161246755725092283 -0.074149617202230455604 -0.18065018788300218899 0.023397907676493270163 -0.35541954282655247033 0.33034684439631134545 0.45037409824373253464 -0.1913800837661025489;0.040545335201453466811 -0.44925413885921516854 -0.45118086884175268025 0.30556320239095152713 -0.12636085755829387645 0.28314904249472272468 0.45632255372791624692 -0.14800826569292471757 0.063642245815038911427 -0.051781602987238772862 -0.2978201262871807975 0.35832936598729586697 -0.34391987447171207259 0.081516225705271616597 -0.49549805463819124318 -0.34275933503793865054 -0.24509493154395597947 0.022392610979893874668 -0.30071994850882505235 -0.24353646419229521558 0.14506805234011771466 0.031877881318843802327 0.12085877440891942824 0.048068927781175073422 -0.37811922471636882914 0.4243122583096761713 -0.24409868315751273582 0.26170786786305660909 0.49657769504995857845 0.14279735742449831126;-0.051190694840918531117 0.36058141705200968952 0.10719715137198443378 0.047089451300239067166 -0.10171151960347178667 -0.30272614810816489417 -0.0067128477808597155144 -0.34231942727399472526 -0.2379835607078446269 -0.33301449382517867015 -0.018802109744567047783 -0.47281204866024245659 -0.25863976473898431241 0.45131132290149716946 0.32260692448217120898 0.094145387949698386421 -0.41919382539798982767 0.30138456435417776413 -0.33640076655042139286 0.16805969529813666319 -0.1772422282406647398 -0.32000056590921804878 0.19740021545209615605 0.057330241372029723534 -0.48449050785354857984 0.43666196612598590088 -0.11210957385942893483 0.29023502924741240161 -0.31918367561077426453 -0.37548887817326126459];

% Layer 3
b3 = [-0.96590759399261205687;0.65518237690886016455];
LW3_2 = [-0.12652910035362388563 0.54721321338095962883 1.7394409056796724666 0.20604990241776172111 0.75976271335721634603 -0.39939733936736737663 0.53690461117487553455 0.64496248452052284961 -1.4379359123021167033 -0.89196167691788352805 0.820561863632904398 0.2004639690892129622 0.5601575549190901393 -1.4853311685865768776 0.58267618568151879899 -0.68276509489342684933 1.0177982103360216914 -0.67410683151531924917 -0.11416883825170096034 0.18243267653030717512 1.3087963262545285748 1.0349853170739951036 0.6088248514790729482 0.070144566619866483004 -0.40984837411340974134 0.55820454217012571707 0.82868154620472145311 -0.37695759244165905066 -0.49906070356574377955 -0.52855312982019420076;0.93258548705613530938 -0.88104664225479500939 -1.5913834484207973752 0.48873955299807064767 -0.52130869137041813133 1.3375687617936253826 0.79269518713922515474 -0.46507369742945203761 1.3408223728265560304 0.87561180357246437556 -0.30751164270187558714 0.45743413280844402724 0.041252457982606439979 1.1414164666769790468 0.25311605810836801389 0.61742719307263638218 -0.01717781686214910758 -0.61418560426696577892 -0.30421000253935848168 -0.88921955863620738558 -0.083475123930194503052 0.7735021963945171164 -0.17596214933385817547 -0.13914747220071602141 -0.77835030245874370358 -1.0987586198139869254 -0.70258821280303651591 0.19007316315513866911 -0.87465499409968072708 -0.30683093266685923517];

% ===== SIMULATION ========

% Dimensions
Q = size(x1,2); % samples

% Input 1
xp1 = mapminmax_apply(x1,x1_step1);

% Layer 1
a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);

% Layer 2
a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);

% Layer 3
a3 = softmax_apply(repmat(b3,1,Q) + LW3_2*a2);

% Output 1
y1 = a3;
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Competitive Soft Transfer Function
function a = softmax_apply(n,~)
  if isa(n,'gpuArray')
    a = iSoftmaxApplyGPU(n);
  else
    a = iSoftmaxApplyCPU(n);
  end
end
function a = iSoftmaxApplyCPU(n)
  nmax = max(n,[],1);
  n = bsxfun(@minus,n,nmax);
  numerator = exp(n);
  denominator = sum(numerator,1); 
  denominator(denominator == 0) = 1;
  a = bsxfun(@rdivide,numerator,denominator);
end
function a = iSoftmaxApplyGPU(n)
  nmax = max(n,[],1);
  numerator = arrayfun(@iSoftmaxApplyGPUHelper1,n,nmax);
  denominator = sum(numerator,1);
  a = arrayfun(@iSoftmaxApplyGPUHelper2,numerator,denominator);
end
function numerator = iSoftmaxApplyGPUHelper1(n,nmax)
  numerator = exp(n - nmax);
end
function a = iSoftmaxApplyGPUHelper2(numerator,denominator)
  if (denominator == 0)
    a = numerator;
  else
    a = numerator ./ denominator;
  end
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end
